document.addEventListener("DOMContentLoaded",()=>{let{indexName:t,appID:e,apiKey:a,hits:i}=CONFIG.algolia,l=window["algoliasearch/lite"].liteClient(e,a),r=document.querySelector(".search-input"),n=document.querySelector(".search-result-container"),c=e=>{var{title:t,excerpt:a,excerptStrip:r,contentStripTruncate:s}=e._highlightResult;let i=`<li><a href="${e.permalink}" class="search-result-title">${t.value}</a>`;t=a?.value||r?.value||s?.value;return t&&((a=document.createElement("div")).innerHTML=t,i+=`<a href="${e.permalink}"><p class="search-result">${a.textContent.substring(0,100)}...</p></a></li>`),i},u=!1,o=null,d=async(a,r=0)=>{if(u)o={searchText:a,page:r};else{u=!0;var e=Date.now(),s=(await l.search({requests:[{indexName:t,page:r,query:a,hitsPerPage:i.per_page||10,attributesToRetrieve:["permalink"],attributesToHighlight:["title","excerpt","excerptStrip","contentStripTruncate"],highlightPreTag:'<mark class="search-keyword">',highlightPostTag:"</mark>"}]})).results[0];if(0===s.nbHits)n.innerHTML='<div class="search-result-icon"><i class="far fa-frown fa-5x"></i></div>';else{e=CONFIG.i18n.hits_time.replace("${hits}",s.nbHits).replace("${time}",Date.now()-e);let t="";if(1<s.nbPages){t+='<nav class="pagination algolia-pagination">';for(let e=0;e<s.nbPages;e++)e===r?t+=`<span class="page-number current">${e+1}</span>`:t+=`<a class="page-number" href="#" data-index=${e}>${e+1}</a>`;t+="</nav>"}n.innerHTML=`<div class="search-stats">
          <span>${e}</span>
          <img src="${CONFIG.images}/logo-algolia-nebula-blue-full.svg" alt="Algolia">
        </div>
        <hr>
        <ul class="search-result-list">${s.hits.map(c).join("")}</ul>
        `+t,"object"==typeof pjax&&pjax.refresh(n),n.querySelectorAll(".page-number").forEach(t=>{t.addEventListener("click",async e=>{e.preventDefault(),await d(a,Number(t.dataset.index))})})}if(u=!1,null!==o&&(o.searchText!==a||o.page!==r)){let{searchText:e,page:t}=o;o=null,d(e,t)}}};var s=NexT.utils.debounce(async()=>{var e=r.value.trim();""===e?n.innerHTML='<div class="search-result-icon"><i class="fab fa-algolia fa-5x"></i></div>':await d(e,0)},500);r.addEventListener("input",s),document.querySelectorAll(".popup-trigger").forEach(e=>{e.addEventListener("click",()=>{NexT.utils.setGutter(),document.body.classList.add("search-active"),setTimeout(()=>r.focus(),500)})});let p=()=>{NexT.utils.setGutter("0"),document.body.classList.remove("search-active")};document.querySelector(".search-pop-overlay").addEventListener("click",e=>{e.target===document.querySelector(".search-pop-overlay")&&p()}),document.querySelector(".popup-btn-close").addEventListener("click",p),document.addEventListener("pjax:success",p),window.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&"k"===e.key&&(e.preventDefault(),NexT.utils.setGutter(),document.body.classList.add("search-active"),setTimeout(()=>r.focus(),500))}),window.addEventListener("keyup",e=>{"Escape"===e.key&&p()})});