(()=>{let t="unknown",n=navigator.onLine;function o(e,n){let t=document.getElementById("network-status")||((o=document.createElement("div")).className="network-status",o.id="network-status",document.body.appendChild(o),o);var o;t.className="network-status "+e,t.textContent=n,"offline"!==e&&setTimeout(()=>{t.style.opacity="0"},3e3)}function i(){if(navigator.onLine){var e=new Image;let n=Date.now();e.onload=function(){var e=Date.now()-n;3e3<e?(o(t="slow","网络较慢"),a()):1e3<e?(t="medium",console.log("网络速度中等")):(t="fast",console.log("网络速度良好"))},e.onerror=function(){t="error",o("offline","网络连接异常")},e.src="/images/favicon-16x16-next.png?"+Math.random()}else o("offline","网络已断开")}function a(){document.querySelectorAll("img").forEach(e=>{e.src&&!e.dataset.optimized&&(e.dataset.optimized="true",console.log("为慢速网络优化图片:",e.src))}),document.documentElement.style.setProperty("--animation-duration","0s")}function e(){if(window.addEventListener("online",function(){n=!0,o("online","网络已连接"),i()}),window.addEventListener("offline",function(){n=!1,o("offline","网络已断开")}),"connection"in navigator){let n=navigator.connection;function e(){var e=n.effectiveType;"slow-2g"===e||"2g"===e?(o("slow","2G网络 - 已启用省流模式"),a()):"3g"===e&&o("medium","3G网络")}n.addEventListener("change",e),e()}setTimeout(i,2e3),setInterval(i,3e4)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e(),window.networkOptimizer={getStatus:()=>t,isOnline:()=>n,checkQuality:i}})();